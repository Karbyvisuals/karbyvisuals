<section id="challenge">
  <h2 data-i18n="gameTitle">27sun Challenge</h2>
  <p style="margin-bottom:20px; opacity:0.8;" data-i18n="gameRules">
    Pravidla: Chytej foťáky! Pokud dosáhneš skóre <b>27</b>, vygeneruje se ti unikátní kód na <b>30% slevu</b>. 
    Kód je jedinečný – zkopíruj ho a pošli mi ho v poptávce.
  </p>
  
  <div id="game-container">
    <div id="game-ui">Score: 0</div>
    <button id="game-start-btn" onclick="startGame()">HRÁT O SLEVU</button>
    <canvas id="game-canvas"></canvas>
    
    <div id="promo-reveal">
      <h2 style="color:#ff7a18">VYHRÁL JSI!</h2>
      <p>Tvůj unikátní kód na slevu 30%:</p>
      <div id="dynamic-code" style="font-size:24px; font-weight:900; margin:20px 0; letter-spacing:2px; border: 2px dashed #ff7a18; padding: 10px 20px; background: rgba(255,122,24,0.1);">
        GENERUJI...
      </div>
      <p style="font-size:12px; opacity:0.7;">(Tento kód je platný pouze pro tvou poptávku. Pošli mi ho do zpráv.)</p>
      <button class="btn" onclick="location.reload()">Zavřít</button>
    </div>
  </div>
</section>

<script>
/* --- LOGIKA GENEROVÁNÍ KÓDU --- */
function generateSecureCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // Bez 0, O, I pro čitelnost
  let randomPart = '';
  for (let i = 0; i < 4; i++) {
    randomPart += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  // Kód obsahuje prefix SUN30 a náhodné 4 znaky
  return `SUN30-${randomPart}`;
}

/* --- ÚPRAVA V HERMÍ SMYČCE --- */
// (v místě kde hráč dosáhne 27 bodů)
if(score >= 27) {
  gameActive = false;
  const uniqueCode = generateSecureCode();
  document.getElementById('dynamic-code').innerText = uniqueCode;
  document.getElementById('promo-reveal').style.display = 'flex';
}
</script>
